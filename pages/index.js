import Head from 'next/head';
import axios from 'axios';
import { API_URL } from '../helper/env';

import style from '../styles/Home.module.css';
import Search from '../components/molecules/Search';
import Slider from '../components/molecules/SlideRecipe';
import Popular from '../components/molecules/SlidePopular';
import NavBar from '../components/atoms/Navbar';

export async function getStaticProps() {
   try {
      const newRecipe = await axios({
         method: 'GET',
         url: `${API_URL}recipe/latest`,
      });
      const popularRecipe = await axios({
         method: 'GET',
         url: `${API_URL}recipe/all`,
      });
      return {
         props: {
            dataNew: newRecipe?.data?.data,
            dataPopular: popularRecipe?.data?.data,
         },
      };
   } catch (err) {
      return {
         props: {
            dataNew: err.message,
            dataPopular: err.message,
         },
      };
   }
}

function home({ dataNew, dataPopular }) {
   return (
      <>
         <Head>
            <title>Ricette mobile - Form Home</title>
            <meta name="description" content="Generated by create next app" />
            <link rel="icon" href="/icon.png" />
         </Head>
         <div className={style.section}>
            <div className="container fluid">
               <div className="row">
                  <div className="col-12 col-lg-12 d-flex justify-content-center">
                     <Search />
                  </div>
                  <div className="col-12 col-lg-12 me-4 d-flex justify-content-center">
                     <Slider data={dataNew} />
                  </div>
                  <div className="col-12 col-lg-12 d-flex justify-content-center">
                     <Popular data={dataPopular} />
                  </div>
                  <div className="col-12 col-lg-12 d-flex justify-content-center">
                     <NavBar />
                  </div>
               </div>
            </div>
         </div>
      </>
   );
}

export default home;
